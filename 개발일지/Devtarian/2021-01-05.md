#### `2020-01-05 (í™”)`

<br/>

# ğŸ’» 1

## ğŸ“‚1-1 ImgCarousel

<br/>

> src > components > carousel > imgCarousel.js

<br/>

- Q ) carousel itemì˜ widthê°€ ê°€ë³€ì ì¼ ë•Œì˜ carousel 
- A ) 

  * imgCarouselì—ì„œëŠ” ìµœìƒìœ„ elemì˜ widthê°’ì´ ë³„ë„ë¡œ í•„ìš”í•˜ë¯€ë¡œ, useCarouselì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìƒˆë¡œ ë¡œì§ì„ êµ¬ì„±í–ˆë‹¤.

  1. carouselì˜ ìµœìƒìœ„ Elementì˜ widthì— 100%ë¥¼ ì¤€ë‹¤.
  2. useRefë¡œ 1ì˜ Elemì„ ì°¸ì¡° í›„ useLayoutEffectì‹œ ìµœìƒìœ„Elem.current.clientWidth ê°’ì„ ë°›ì•„ì˜¨ë‹¤.
  3. 2ì˜ ê°’ì„ carousel item widthë¡œ ë„˜ê¸´ë‹¤.
  4. ë¸Œë¼ìš°ì € í™”ë©´ì´ ë¦¬ì‚¬ì´ì§• ë  ë•Œë§ˆë‹¤ ê°’ì„ ë™ê¸°í™” í•´ì£¼ê¸° ìœ„í•´ window.innerWidth ê°’ì„ ë°›ì•„ì˜¨ë‹¤.
  5. useLayoutEffectì— 4ì˜ ê°’ì„ dependencyë¡œ ì„¤ì •í•´ í™”ë©´ì´ ë¦¬ì‚¬ì´ì§• ë  ë•Œë§ˆë‹¤ 2ì˜ state ê°’ì´ ë³€ê²½ë˜ë„ë¡ í•œë‹¤.

  - useLayoutEffect     
    
    https://krpeppermint100.medium.com/ts-useref-%EC%9E%90%EC%84%B8%ED%9E%88-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0-typescript-uselayouteffect-c9f1cf02ca5a

    useEffect : ì¼ë‹¨ í™”ë©´ì„ ë³´ì—¬ì£¼ê³  ë³€í™”ë¥¼ ì¤€ë‹¤.      
    useLayoutEffect : ë³€í™”ë¥¼ ì ìš© ì‹œí‚¨ í›„ í™”ë©´ì„ ë³´ì—¬ì¤€ë‹¤.   
    ë¸Œë¼ìš°ì €ê°€ ë Œë”í•  ë•Œ ë³€í™”ê°€ ì™„ë£Œëœ DOMì„ ë™ê¸°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ê²Œ ë˜ë¯€ë¡œ, ì§ì ‘ì ìœ¼ë¡œ DOMì„ ì¡°ì‘í•  ë•Œì—ëŠ” useEffect ëŒ€ì‹  useLayoutEffectë¥¼ ì‚¬ìš©í•œë‹¤.

    <br/>

ImgCarousel
```js
... 
import React, { useState, useLayoutEffect, useRef } from 'react';
import CarouselBtn, { CarouselBtnWrap } from '../CarouselBtn';

const ImgCarousel = ({ carouselData }) => {
  const refWrap = useRef();
  const refCarouselUl = useRef();
  const refCarouselLi = useRef();
  const [wrapW, setWrapW] = useState();
  const [innerW, setInnerW] = useState();
  const [carouselValue, setCarouselValue] = useState({
    currentIndex: 0,
    leftPosition: 0,
    liClientWidth: 0,
    liSideMargin: 0,
    liLength: 0,
  });

  useLayoutEffect(() => {
    function updateInnerW() {
      setInnerW(window.innerWidth);
    }
    window.addEventListener('resize', updateInnerW);
    updateInnerW();
    return () => window.removeEventListener('resize', updateInnerW);
  }, []);

  useLayoutEffect(() => {
    setWrapW(refWrap.current.clientWidth);
  }, [innerW]);

  useLayoutEffect(() => {
    setCarouselValue({
      ...carouselValue,
      liClientWidth: wrapW,
      liLength: refCarouselUl.current?.childElementCount,
    });
  }, [wrapW]);

  const onCarouselBtnClick = (newIndex, newLeftPosition) => {
    setCarouselValue({ ...carouselValue, currentIndex: newIndex, leftPosition: newLeftPosition });
  };

  return (
    <Wrap ref={refWrap}>
      <CarouselUl ref={refCarouselUl} value={carouselValue} wrapw={wrapW}>
        {carouselData.map((data, index) => (
          <li key={index} data={data} ref={refCarouselLi}>
            <img src={data ? data : noImg} alt="" />
          </li>
        ))}
      </CarouselUl>
      <CarouselBtn value={carouselValue} onCarouselBtnClick={onCarouselBtnClick} />
    </Wrap>
 );
};

export default ImgCarousel;

export const Wrap = styled.section`
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;

  ${CarouselBtnWrap} {
    top: 0px;
    height: 100%;
  }
`;

export const CarouselUl = styled.ul`
  width: ${(props) => (props.value.liClientWidth + props.value.liSideMargin * 2) * props.value.liLength}px;
  height: 100%;
  position: absolute;
  left: ${(props) => props.value.leftPosition}px;
  transition: all 0.3s ease;

  li {
    float: left;
    width: ${(props) => props.value.liClientWidth}px;
    height: 100%;
    margin: 0;
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
`;

...

```